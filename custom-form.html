<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Моя форма</title>
</head>
<body>
  <form id="myForm">
    <label>Имя:</label>
    <input type="text" name="name" required><br><br>

    <label>Выбор кода:</label>
    <select name="code" id="codes"></select><br><br>

    <label>Комментарий:</label>
    <textarea name="comment"></textarea><br><br>

    <button type="submit">Отправить</button>
  </form>

  <script>
    // загрузка справочников
    fetch('YOUR_APPS_SCRIPT_URL?action=getOptions')
      .then(r => r.json()).then(data => {
        const sel = document.getElementById('codes');
        data.forEach(v => {
          let opt = document.createElement('option');
          opt.value = v; opt.text = v;
          sel.appendChild(opt);
        });
      });

    document.getElementById('myForm').onsubmit = e => {
      e.preventDefault();
      const fd = new FormData(e.target);
      fetch('YOUR_APPS_SCRIPT_URL?action=saveData', {
        method:'POST', body:fd
      }).then(r => r.text()).then(msg => alert(msg));
    }
  </script>
</body>
</html>
