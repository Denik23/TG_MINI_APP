/* ---------- Палитры ---------- */
:root{
  --bg:#f6f8fb; --fg:#0b1220; --muted:#5f6b83; --card:#fff; --border:#e6ebf2;
  --accent:#1478ff; --shadow:0 10px 30px rgba(16,24,40,.08);
  --radius-lg:20px; --radius-md:14px;
}
:root[data-theme="dark"]{
  --bg:#0b0f17; --fg:#ecf1f9; --muted:#98a2b3; --card:#121826; --border:#232b3d;
  --accent:#3aa0ff; --shadow:0 10px 30px rgba(0,0,0,.28);
}

/* ---------- База ---------- */
*{box-sizing:border-box}
html,body{height:100%}
html{-webkit-text-size-adjust:100%}
body{
  margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
  color:var(--fg);
  background: radial-gradient(1200px 600px at 100% -10%, rgba(20,120,255,.10), transparent 60%),
              radial-gradient(1200px 600px at -20% 100%, rgba(255,87,34,.10), transparent 60%),
              var(--bg);
  overscroll-behavior: contain;
}

/* ---------- Шапка ---------- */
.app-header{
  position:sticky; top:0; z-index:10;
  background:linear-gradient(180deg,rgba(255,255,255,.6),rgba(255,255,255,0));
  backdrop-filter:blur(8px);
  border-bottom:1px solid var(--border);
}
:root[data-theme="dark"] .app-header{
  background:linear-gradient(180deg,rgba(11,15,23,.7),rgba(11,15,23,0));
}
.brand{display:flex; align-items:center; justify-content:center; padding:14px 16px;}
.brand-text{text-align:center; line-height:1;}
.brand-name{font-weight:800; letter-spacing:.3px; font-size:20px;}
.brand-sub{margin-top:4px; color:var(--muted); font-size:12px;}

/* ---------- Поиск + кнопка добавить ---------- */
.toolbar{
  padding:12px 16px;
  display:grid; grid-template-columns: 1fr auto; gap:10px;
}
.search{
  width:100%; padding:12px 16px; border-radius:999px;
  border:1px solid var(--border); background:var(--card); color:var(--fg);
  outline:none; box-shadow:inset 0 -1px 0 rgba(16,24,40,.04);
  font-size:16px; /* важно для iOS, чтобы не было зума */
}
.search:focus{box-shadow:0 0 0 3px rgba(20,120,255,.18)}

/* ---------- Карточки ---------- */
.cards{padding:16px; display:grid; gap:14px;}
.card{
  background:var(--card); border:1px solid var(--border);
  border-radius:var(--radius-lg); padding:16px; box-shadow:var(--shadow);
}
.card-title{font-weight:700; font-size:16px;}
.card-desc{color:var(--muted); font-size:14px; margin-top:6px;}
.card-actions{
  margin-top:12px; display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
}
.actions-left, .actions-right{display:flex; gap:10px; flex-wrap:wrap}

/* ---------- Кнопки ---------- */
.btn{border-radius:12px; padding:10px 14px; cursor:pointer; border:1px solid transparent; font-weight:700; touch-action: manipulation;}
.btn:active{transform:translateY(1px)}
.btn-primary{
  background:linear-gradient(180deg,var(--accent),color-mix(in srgb,var(--accent) 82%,#0d3c80));
  color:#fff; box-shadow:0 6px 16px color-mix(in srgb,var(--accent) 35%, transparent);
}
.btn-ghost{background:transparent; color:var(--muted); border:1px solid var(--border);}
.btn-danger{background:#e23a3a; color:#fff;}
.btn-sm{padding:8px 10px; border-radius:10px; font-weight:700}

/* ---------- Лист с формой ---------- */
.sheet{position:fixed; inset:0; z-index:20; display:flex; flex-direction:column; background:var(--bg);
  transform:translateY(100%); transition:transform .25s ease;}
.sheet.open{transform:translateY(0)} .sheet.hidden{display:none}
.sheet-header{display:grid; grid-template-columns:auto 1fr auto; align-items:center; gap:8px;
  padding:10px 12px; border-bottom:1px solid var(--border); background:var(--bg);}
.sheet-title{font-weight:800; font-size:16px; text-align:center;}
.back-btn{background:var(--card); border:1px solid var(--border); color:var(--fg);}
.frame-wrap{position:relative; flex:1;}
.sheet-frame{border:0; width:100%; height:100%; background:#fff; border-radius:0;}
.loader{position:absolute; inset:0; display:grid; place-items:center;
  background:radial-gradient(400px 200px at 20% 10%, rgba(20,120,255,.10), transparent 60%),
             radial-gradient(400px 200px at 80% 90%, rgba(255,87,34,.10), transparent 60%),
             var(--bg);}
.loader::after{content:""; width:36px; height:36px; border-radius:50%;
  border:4px solid color-mix(in srgb, var(--accent) 40%, #fff); border-top-color:transparent;
  animation:spin .9s linear infinite;}
[aria-hidden="true"].loader{display:none}
@keyframes spin{to{transform:rotate(360deg)}}
.spacer{width:36px}

/* ---------- Модалка ---------- */
.modal{position:fixed; inset:0; z-index:30; display:flex; align-items:center; justify-content:center;
  background:color-mix(in srgb, var(--bg) 40%, #0000); backdrop-filter:blur(6px);}
.modal.hidden{display:none}
.modal-dialog{width:min(720px, 92vw); background:var(--card); border:1px solid var(--border);
  border-radius:16px; box-shadow:var(--shadow); overflow:hidden;}
.modal-header{display:flex; align-items:center; justify-content:space-between; gap:8px;
  padding:12px 14px; border-bottom:1px solid var(--border);}
.modal-title{font-weight:800;}
.modal-body{padding:14px;}
.grid{display:grid; gap:12px;}
.field span{display:block; font-size:13px; color:var(--muted); margin-bottom:6px;}
.field input,.field textarea{
  width:100%; padding:12px 14px; border-radius:12px; border:1px solid var(--border);
  background:var(--bg); color:var(--fg);
  font-size:16px; /* критично для iOS, чтобы не было зума при фокусе */
}
.help{color:var(--muted); font-size:12px; margin-top:6px}
.modal-actions{margin-top:8px; display:flex; gap:10px; flex-wrap:wrap}
.app-loader{ position:fixed; inset:0; z-index:999; }
